---
mode: agent
model: Claude Sonnet 4 (copilot)
---

Refactor crankshaft to use the latest version of the pi-gen repo. Refactor it in the  image_builder/crankshaft directory.
Use the following steps:
1. Clone the latest pi-gen repository from https://github.com/RPi-Distro/pi-gen.git
2. Compare the structure of the pi-gen repository with the current crankshaft implementation.
3. Identify the differences and similarities between the two structures.
4. Refactor the crankshaft code to align with the latest pi-gen structure, ensuring compatibility and functionality.
5. Save to the image_builder/crankshaft directory.
6. Test the refactored crankshaft to ensure it works as expected with the latest pi-gen structure.
7. Document any changes made during the refactoring process for future reference.
8. Commit the changes to the repository with a clear commit message indicating the update to the latest pi-gen version.
